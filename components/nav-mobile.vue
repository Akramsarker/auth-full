<template>
  <div
    class="mobile-nav bg-[#fff] w-full px-4 py-4 fixed top-0 left-0 overflow-hidden z-40"
    style="box-shadow: 0px 3px 15px 0px #bcbcbc40"
  >
    <div class="header-content flex justify-between items-center flex-row">
      <div class="flex gap-4">
        <button @click.stop="showMenuPopup = !showMenuPopup">
          <svg
            width="123"
            height="30"
            viewBox="0 0 123 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M6.552 21.24C5.416 21.24 4.44 21.016 3.624 20.568C2.808 20.104 2.176 19.48 1.728 18.696C1.296 17.896 1.08 16.984 1.08 15.96C1.08 14.984 1.328 14.096 1.824 13.296C2.32 12.496 2.984 11.856 3.816 11.376C4.648 10.896 5.576 10.656 6.6 10.656C7.912 10.656 9 11.04 9.864 11.808C10.728 12.576 11.312 13.632 11.616 14.976L3.432 17.856L2.904 16.536L9.624 14.088L9.144 14.4C8.952 13.872 8.632 13.416 8.184 13.032C7.736 12.632 7.152 12.432 6.432 12.432C5.824 12.432 5.28 12.584 4.8 12.888C4.32 13.176 3.944 13.576 3.672 14.088C3.4 14.6 3.264 15.184 3.264 15.84C3.264 16.528 3.408 17.136 3.696 17.664C3.984 18.176 4.376 18.584 4.872 18.888C5.384 19.176 5.96 19.32 6.6 19.32C7.032 19.32 7.448 19.24 7.848 19.08C8.264 18.92 8.648 18.712 9 18.456L10.032 20.112C9.536 20.448 8.976 20.72 8.352 20.928C7.744 21.136 7.144 21.24 6.552 21.24ZM18.5408 21.24C17.6128 21.24 16.7648 21.04 15.9967 20.64C15.2448 20.24 14.6448 19.656 14.1968 18.888C13.7648 18.104 13.5488 17.152 13.5488 16.032C13.5488 14.928 13.7808 13.976 14.2448 13.176C14.7088 12.36 15.3248 11.736 16.0928 11.304C16.8768 10.872 17.7328 10.656 18.6608 10.656C19.5888 10.656 20.3728 10.872 21.0128 11.304C21.6528 11.72 22.1408 12.216 22.4768 12.792L22.3328 13.176L22.5488 11.064H24.6128V21H22.3808V18.408L22.6208 18.984C22.5568 19.144 22.4128 19.352 22.1888 19.608C21.9808 19.848 21.6928 20.096 21.3248 20.352C20.9728 20.608 20.5648 20.824 20.1008 21C19.6368 21.16 19.1168 21.24 18.5408 21.24ZM19.1408 19.392C19.7008 19.392 20.2048 19.288 20.6528 19.08C21.1008 18.872 21.4688 18.584 21.7568 18.216C22.0608 17.832 22.2688 17.376 22.3808 16.848V14.904C22.2528 14.424 22.0288 14.008 21.7088 13.656C21.3888 13.288 21.0048 13.008 20.5568 12.816C20.1088 12.608 19.6128 12.504 19.0688 12.504C18.4768 12.504 17.9328 12.648 17.4368 12.936C16.9408 13.224 16.5408 13.624 16.2368 14.136C15.9488 14.648 15.8048 15.248 15.8048 15.936C15.8048 16.576 15.9568 17.16 16.2608 17.688C16.5648 18.216 16.9728 18.632 17.4848 18.936C17.9968 19.24 18.5488 19.392 19.1408 19.392ZM31.2593 21.192C30.5553 21.192 29.8673 21.072 29.1953 20.832C28.5393 20.576 27.9953 20.2 27.5633 19.704L28.4993 18.408C28.9153 18.808 29.3393 19.112 29.7713 19.32C30.2193 19.512 30.6593 19.608 31.0913 19.608C31.4113 19.608 31.7073 19.568 31.9793 19.488C32.2513 19.408 32.4673 19.28 32.6273 19.104C32.8033 18.912 32.8913 18.656 32.8913 18.336C32.8913 17.984 32.7713 17.704 32.5312 17.496C32.3073 17.288 32.0113 17.12 31.6433 16.992C31.2913 16.864 30.9153 16.744 30.5153 16.632C29.6993 16.36 29.0753 15.984 28.6433 15.504C28.2113 15.024 27.9953 14.44 27.9953 13.752C27.9953 13.224 28.1233 12.736 28.3793 12.288C28.6513 11.824 29.0433 11.448 29.5553 11.16C30.0833 10.872 30.7313 10.728 31.4993 10.728C32.1873 10.728 32.8033 10.816 33.3473 10.992C33.8913 11.152 34.4033 11.424 34.8833 11.808L33.9953 13.2C33.7073 12.896 33.3633 12.672 32.9633 12.528C32.5633 12.384 32.2033 12.304 31.8833 12.288C31.6113 12.272 31.3473 12.312 31.0913 12.408C30.8513 12.504 30.6513 12.64 30.4913 12.816C30.3313 12.992 30.2513 13.2 30.2513 13.44C30.2513 13.776 30.3633 14.048 30.5873 14.256C30.8113 14.464 31.0993 14.632 31.4513 14.76C31.8193 14.872 32.1793 14.992 32.5312 15.12C33.0273 15.264 33.4673 15.456 33.8513 15.696C34.2353 15.936 34.5393 16.232 34.7633 16.584C35.0033 16.936 35.1233 17.376 35.1233 17.904C35.1233 18.496 34.9793 19.048 34.6913 19.56C34.4193 20.056 33.9953 20.456 33.4193 20.76C32.8593 21.048 32.1393 21.192 31.2593 21.192ZM39.0887 25.776L45.6407 11.064H47.7047L41.2967 25.776H39.0887ZM41.5367 21.072L36.7607 11.064H39.2807L43.2887 19.944L41.5367 21.072Z"
              fill="#665EF3"
            />
            <rect
              x="51"
              width="72"
              height="30"
              rx="3"
              fill="url(#paint0_linear_220_795)"
            />
            <path
              d="M57.62 11.72H59.48V20H57.62V11.72ZM57.48 8.72C57.48 8.42667 57.5933 8.18 57.82 7.98C58.06 7.78 58.32 7.68 58.6 7.68C58.88 7.68 59.1267 7.78 59.34 7.98C59.5667 8.18 59.68 8.42667 59.68 8.72C59.68 9.02667 59.5667 9.28 59.34 9.48C59.1267 9.66667 58.88 9.76 58.6 9.76C58.32 9.76 58.06 9.66 57.82 9.46C57.5933 9.26 57.48 9.01333 57.48 8.72ZM64.3581 11.72L64.5181 13.74L64.4381 13.42C64.7048 12.8067 65.1381 12.32 65.7381 11.96C66.3381 11.5867 67.0315 11.4 67.8181 11.4C68.6048 11.4 69.2448 11.6333 69.7381 12.1C70.2448 12.5533 70.5048 13.1467 70.5181 13.88V20H68.6381V14.54C68.6248 14.0867 68.4915 13.72 68.2381 13.44C67.9981 13.1467 67.6181 13 67.0981 13C66.6181 13 66.1848 13.1333 65.7981 13.4C65.4115 13.6667 65.1048 14.0333 64.8781 14.5C64.6648 14.9667 64.5581 15.5067 64.5581 16.12V20H62.6981V11.72H64.3581ZM76.8198 20.24L72.2198 11.72H74.4198L77.5398 18.3L76.3998 18.26L79.2598 11.72H81.3398L76.9198 20.24H76.8198ZM82.4273 15.78C82.4273 14.9533 82.6207 14.2067 83.0073 13.54C83.4073 12.8733 83.954 12.3467 84.6473 11.96C85.3407 11.5733 86.1273 11.38 87.0073 11.38C87.914 11.38 88.7073 11.5733 89.3873 11.96C90.0673 12.3467 90.594 12.8733 90.9673 13.54C91.3407 14.2067 91.5273 14.9533 91.5273 15.78C91.5273 16.6067 91.3407 17.36 90.9673 18.04C90.594 18.7067 90.0607 19.2333 89.3673 19.62C88.6873 20.0067 87.894 20.2 86.9873 20.2C86.1073 20.2 85.3207 20.02 84.6273 19.66C83.9473 19.2867 83.4073 18.7733 83.0073 18.12C82.6207 17.4533 82.4273 16.6733 82.4273 15.78ZM84.2873 15.8C84.2873 16.3333 84.4073 16.82 84.6473 17.26C84.8873 17.6867 85.2073 18.0267 85.6073 18.28C86.0207 18.5333 86.474 18.66 86.9673 18.66C87.4873 18.66 87.9473 18.5333 88.3473 18.28C88.7607 18.0267 89.0807 17.6867 89.3073 17.26C89.534 16.82 89.6473 16.3333 89.6473 15.8C89.6473 15.2667 89.534 14.7867 89.3073 14.36C89.0807 13.92 88.7607 13.5733 88.3473 13.32C87.9473 13.0533 87.4873 12.92 86.9673 12.92C86.4607 12.92 86.0007 13.0533 85.5873 13.32C85.1873 13.5867 84.8673 13.94 84.6273 14.38C84.4007 14.8067 84.2873 15.28 84.2873 15.8ZM94.0458 11.72H95.9058V20H94.0458V11.72ZM93.9058 8.72C93.9058 8.42667 94.0191 8.18 94.2458 7.98C94.4858 7.78 94.7458 7.68 95.0258 7.68C95.3058 7.68 95.5524 7.78 95.7658 7.98C95.9924 8.18 96.1058 8.42667 96.1058 8.72C96.1058 9.02667 95.9924 9.28 95.7658 9.48C95.5524 9.66667 95.3058 9.76 95.0258 9.76C94.7458 9.76 94.4858 9.66 94.2458 9.46C94.0191 9.26 93.9058 9.01333 93.9058 8.72ZM105.844 19.24C105.471 19.5333 105.024 19.7667 104.504 19.94C103.984 20.1133 103.464 20.2 102.944 20.2C102.037 20.2 101.244 20.02 100.564 19.66C99.8839 19.3 99.3506 18.8 98.9639 18.16C98.5906 17.5067 98.4039 16.74 98.4039 15.86C98.4039 14.98 98.6039 14.2133 99.0039 13.56C99.4172 12.9067 99.9506 12.4067 100.604 12.06C101.271 11.7 101.984 11.52 102.744 11.52C103.411 11.52 104.004 11.6133 104.524 11.8C105.057 11.9867 105.511 12.24 105.884 12.56L104.964 13.76C104.724 13.5733 104.431 13.4067 104.084 13.26C103.737 13.1133 103.344 13.04 102.904 13.04C102.424 13.04 101.977 13.1667 101.564 13.42C101.164 13.66 100.844 13.9933 100.604 14.42C100.377 14.8467 100.264 15.3267 100.264 15.86C100.264 16.3667 100.384 16.84 100.624 17.28C100.864 17.7067 101.197 18.0467 101.624 18.3C102.051 18.54 102.537 18.66 103.084 18.66C103.444 18.66 103.771 18.6067 104.064 18.5C104.371 18.3933 104.644 18.2467 104.884 18.06L105.844 19.24ZM112.085 20.2C111.138 20.2 110.325 20.0133 109.645 19.64C108.965 19.2533 108.438 18.7333 108.065 18.08C107.705 17.4133 107.525 16.6533 107.525 15.8C107.525 14.9867 107.732 14.2467 108.145 13.58C108.558 12.9133 109.112 12.38 109.805 11.98C110.498 11.58 111.272 11.38 112.125 11.38C113.218 11.38 114.125 11.7 114.845 12.34C115.565 12.98 116.052 13.86 116.305 14.98L109.485 17.38L109.045 16.28L114.645 14.24L114.245 14.5C114.085 14.06 113.818 13.68 113.445 13.36C113.072 13.0267 112.585 12.86 111.985 12.86C111.478 12.86 111.025 12.9867 110.625 13.24C110.225 13.48 109.912 13.8133 109.685 14.24C109.458 14.6667 109.345 15.1533 109.345 15.7C109.345 16.2733 109.465 16.78 109.705 17.22C109.945 17.6467 110.272 17.9867 110.685 18.24C111.112 18.48 111.592 18.6 112.125 18.6C112.485 18.6 112.832 18.5333 113.165 18.4C113.512 18.2667 113.832 18.0933 114.125 17.88L114.985 19.26C114.572 19.54 114.105 19.7667 113.585 19.94C113.078 20.1133 112.578 20.2 112.085 20.2Z"
              fill="white"
            />
            <defs>
              <linearGradient
                id="paint0_linear_220_795"
                x1="14.5"
                y1="-36"
                x2="199.5"
                y2="48.5"
                gradientUnits="userSpaceOnUse"
              >
                <stop stop-color="#40DBD6" />
                <stop offset="0.431" stop-color="#766EFF" />
                <stop offset="1" stop-color="#665EF3" />
              </linearGradient>
            </defs>
          </svg>
        </button>
        <!-- <img class="w-[162px]" src="/static/ai-story-logo.png" alt=""> -->
      </div>
      <div class="flex items-center ml-auto">
        <template v-if="store.userDetails">
          <div class="mr-4">
            <NuxtLink
              class="bg-[#746CFD] h-[30px] w-[30px] rounded-[50%] text-center flex justify-center items-center text-[#fff]"
              to="/invoice/new"
            >
              <svg
                width="28"
                height="28"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8.03336 7.46662V7.96662H8.53336H11.2C11.2184 7.96662 11.2333 7.9815 11.2333 7.99995C11.2333 8.0184 11.2184 8.03328 11.2 8.03328H8.53336H8.03336V8.53328V11.2C8.03336 11.2183 8.01841 11.2333 8.00003 11.2333C7.98165 11.2333 7.9667 11.2183 7.9667 11.2V8.53328V8.03328H7.4667H4.80003C4.78163 8.03328 4.7667 8.01836 4.7667 7.99995C4.7667 7.98154 4.78163 7.96662 4.80003 7.96662H7.4667H7.9667V7.46662V4.79995C7.9667 4.78154 7.98162 4.76662 8.00003 4.76662C8.01844 4.76662 8.03336 4.78154 8.03336 4.79995V7.46662ZM1.43555 7.99965C1.43555 4.37427 4.37451 1.4353 7.9999 1.4353C11.6253 1.4353 14.5642 4.37427 14.5642 7.99965C14.5642 11.625 11.6253 14.5641 7.9999 14.5641C4.37451 14.5641 1.43555 11.625 1.43555 7.99965ZM7.9999 1.44863C4.38187 1.44863 1.44887 4.38163 1.44887 7.99965C1.44887 11.6176 4.38187 14.5507 7.9999 14.5507C11.6179 14.5507 14.5509 11.6176 14.5509 7.99965C14.5509 4.38164 11.6179 1.44863 7.9999 1.44863Z"
                  stroke="white"
                />
              </svg>
            </NuxtLink>
          </div>
          <!-- <div class="mr-8">
                        <svg width="34" height="38" viewBox="0 0 34 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M30.6097 25.8218V18.587C30.6097 12.2192 26.2204 6.85811 20.3086 5.36854C20.5565 4.87075 20.6967 4.31033 20.6967 3.71747C20.6967 1.66762 19.029 0 16.9793 0C14.9295 0 13.2619 1.66762 13.2619 3.71739C13.2619 4.31025 13.4021 4.87068 13.65 5.36846C7.73814 6.85804 3.34884 12.2192 3.34884 18.5869V25.8217C1.90655 26.3333 0.870605 27.7106 0.870605 29.326C0.870605 31.3758 2.53823 33.0434 4.588 33.0434H10.9083C11.4839 35.8681 13.9872 38 16.9793 38C19.9713 38 22.4746 35.8681 23.0503 33.0434H29.3706C31.4204 33.0434 33.088 31.3758 33.088 29.3261C33.0879 27.7107 32.052 26.3333 30.6097 25.8218ZM16.9793 2.47824C17.6625 2.47824 18.2184 3.03414 18.2184 3.71739C18.2184 4.40065 17.6625 4.95655 16.9793 4.95655C16.296 4.95655 15.7401 4.40065 15.7401 3.71739C15.7401 3.03414 16.296 2.47824 16.9793 2.47824ZM16.9793 35.5218C15.3638 35.5218 13.9865 34.4775 13.475 33.0352H20.4836C19.972 34.4775 18.5947 35.5218 16.9793 35.5218ZM29.3706 30.5652H4.588C3.90474 30.5652 3.34884 30.0093 3.34884 29.3261C3.34884 28.6428 3.90474 28.0869 4.588 28.0869H7.06631C7.75061 28.0869 8.30547 27.5321 8.30547 26.8477C8.30547 26.1634 7.75068 25.6086 7.06631 25.6086H5.82708V18.5868C5.82708 12.4375 10.8299 7.43464 16.9793 7.43464C23.1286 7.43464 28.1314 12.4375 28.1314 18.5868V25.6086H26.8913C26.207 25.6086 25.6521 26.1634 25.6521 26.8477C25.6521 27.5321 26.2069 28.0869 26.8913 28.0869H29.3706C30.0539 28.0869 30.6098 28.6428 30.6098 29.3261C30.6098 30.0093 30.0538 30.5652 29.3706 30.5652Z"
                                fill="url(#paint0_linear_102_809)" />
                            <defs>
                                <linearGradient id="paint0_linear_102_809" x1="33.912" y1="1.87109" x2="-1.19797"
                                    y2="19.5838" gradientUnits="userSpaceOnUse">
                                    <stop offset="0.436" stop-color="#fff" />
                                    <stop offset="0.767964" stop-color="#fff" />
                                    <stop offset="1" stop-color="#fff" />
                                </linearGradient>
                            </defs>
                        </svg>
                    </div> -->
          <div>
            <img
              v-if="store?.userDetails?.photoURL"
              :src="store.userDetails.photoURL"
              :alt="store?.userDetails?.displayName"
              class="h-10 w-10 bg-gray-200 border rounded-full"
              @click.stop="showPopUpProfileBox = !showPopUpProfileBox"
            />
            <img
              v-else
              :src="`https://api.dicebear.com/7.x/initials/svg?seed=${store?.userDetails?.displayName}&backgroundColor=A91CDA`"
              :alt="store?.userDetails?.displayName"
              class="h-10 w-10 bg-gray-200 border rounded-full"
              @click.stop="showPopUpProfileBox = !showPopUpProfileBox"
            />
          </div>
        </template>
        <div v-else>
          <NuxtLink class="mr-8 text-[black] font-medium" to="/Signin"
            >Signin</NuxtLink
          >
          <NuxtLink class="mr-8 text-[black] font-medium" to="/Signup"
            >Signup</NuxtLink
          >
        </div>
      </div>
    </div>
  </div>
  <div
    v-show="showPopUpProfileBox"
    class="top-16 right-6 z-50 popup"
    style="position: fixed; width: 320px"
  >
    <popup-profile-box />
  </div>
</template>
<script setup>
import { onMounted } from "vue";
import { useMainStore } from "~/stores/index.js";
const store = useMainStore();
const showPopUpProfileBox = ref(false);
const showMenuPopup = ref(false);
onMounted(() => {
  const target = document.querySelector(".popup");
  document.addEventListener("click", (event) => {
    const withinBoundaries = event.composedPath().includes(target);
    if (!withinBoundaries) showPopUpProfileBox.value = false;
  });
});
</script>
<style scoped>
.mobile-nav {
  display: block;
}

@media screen and (min-width: 1024px) {
  .mobile-nav {
    display: none;
  }
}
</style>
